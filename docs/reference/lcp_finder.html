<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Create an object for finding LCPs on a quadtree — lcp_finder • quadtree</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Create an object for finding LCPs on a quadtree — lcp_finder" />
<meta property="og:description" content="This function creates an LcpFinder object that can then be used
  by find_lcp and find_lcps to find
  least-cost paths (LCPs)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">quadtree</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/quadtree-architecture.html">Vignette Title</a>
    </li>
    <li>
      <a href="../articles/quadtree-creation.html">Quadtree creation</a>
    </li>
    <li>
      <a href="../articles/quadtree-lcp.html">Finding Least-Cost Paths on a Quadtree</a>
    </li>
    <li>
      <a href="../articles/quadtree-usage.html">Using Quadtrees</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://gitlab.com/dafriend/quadtree/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create an object for finding LCPs on a quadtree</h1>
    <small class="dont-index">Source: <a href='https://gitlab.com/dafriend/quadtree/blob/master/R/lcp.R'><code>R/lcp.R</code></a></small>
    <div class="hidden name"><code>lcp_finder.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function creates an LcpFinder object that can then be used
  by <code><a href='find_lcp.html'>find_lcp</a></code> and <code><a href='find_lcps.html'>find_lcps</a></code> to find
  least-cost paths (LCPs).</p>
    </div>

    <pre class="usage"><span class='co'># S4 method for Quadtree,numeric</span>
<span class='fu'>lcp_finder</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, xlim <span class='op'>=</span> <span class='cn'>NULL</span>, ylim <span class='op'>=</span> <span class='cn'>NULL</span>, search_by_centroid <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>a <code><a href='Quadtree-class.html'>Quadtree</a></code> object to be used as a resistance surface</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>numeric vector with 2 elements - the x and y coordinates
of the starting point of the path(s)</p></td>
    </tr>
    <tr>
      <th>xlim</th>
      <td><p>numeric vector with 2 elements - constrains the nodes included
in the network to those whose extent overlaps with the range specified in
<code>xlim</code>. If <code>NULL</code> the x limits of <code>x</code> are used</p></td>
    </tr>
    <tr>
      <th>ylim</th>
      <td><p>same as <code>xlim</code>, but for y</p></td>
    </tr>
    <tr>
      <th>search_by_centroid</th>
      <td><p>boolean; determines which cells are considered to
be "in" the box specified by <code>xlim</code> and <code>ylim</code>. If <code>FALSE</code>
(the default) any cell that overlaps with the box is included. If
<code>TRUE</code>, a cell is only included if its *centroid* falls inside the
box. See 'Details' for more.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>returns an LCP finder object. If <code>start_point</code> falls outside of
  the quadtree extent, <code>NULL</code> is returned.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function creates an object that can then be used by
  <code><a href='find_lcp.html'>find_lcp</a></code> or <code><a href='find_lcps.html'>find_lcps</a></code> to calculate
  least-cost paths on the quadtree.</p>  
<p>See the vignette 'quadtree-lcp' for more details.</p>  
<p><code>search_by_centroid</code> is important because it defines what it means for
  a cell to "in" the box defined by <code>xlim</code> and <code>ylim</code>. If
  <code>search_by_centroid</code> is <code>FALSE</code>, it is possible for least-cost
  paths to travel outside the specified box (since a cell may overlap with
  the box but have its centroid outside the box.) If <code>TRUE</code>, all LCPs
  are guaranteed to be fully contained within the box since cells are only
  included if the centroid falls in the box.</p>  
<p>Dijkstra's algorithm is used to find least-cost-paths (LCPs) on a network.
  The network used in this case consists of the cell centroids (nodes) and
  the neighbor connections (edges). The cost of each edge is taken as the
  length of the edge times the weight - because the edge travels between two
  cells, the cost of the edge is weighted by the distance that falls within
  each cell.</p>
<p>Dijkstra's algorithm essentially builds a tree data structure, where the
  starting node is the root of the tree. It iteratively builds the tree
  structure, and in each iteration it adds the node that is "closest" to the
  current tree - that is, it chooses the node which is easiest to get to. The
  result is that even if only one LCP is desired, LCPs to other nodes are
  also calculated in the process.</p>
<p>The LCP finder object internally stores the results as a tree-like
  structure. Finding the LCP to a given point can be seen as a two-step
  process. First, construct the tree structure as described above. Second,
  starting from the destination node, travel up the tree, keeping track of
  the sequence of nodes passed through, until the root (the starting node) is
  reached. This sequence of nodes (in reverse, since we started from the
  destination node) is the LCP to that point.</p>
<p>Once the tree has been constructed, LCPs can be found to any of the of the
  child nodes without further computation. This allows for efficient
  computation of multiple LCPs. The LCP finder saves state - whenever an LCP
  is asked to be calculated, it first checks whether or not a path has been
  found to that node already - if so, it simply returns the path using the
  process described above. If not, it builds out the existing tree until the
  desired node has been reached.</p>
<p>Two slightly different ways of calculating LCPs are provided that differ in
  their stop criteria - that is, the condition on which the tree stops being
  built. <code><a href='find_lcp.html'>find_lcp</a>()</code> finds a path to a specific point. As soon
  as that node has been added to the tree, the algorithm stops and the LCP is
  returned. <code><a href='find_lcps.html'>find_lcps</a>()</code> doesn't use a destination point -
  instead, the tree continues to be built until the paths exceed a given
  cost-distance, depending on which one the user selects. In addition, this
  constraint can be ignored in order to find all LCPs within the given set of
  nodes. See the documentation of those two functions for more details.</p>
<p>An important note is that because of the heterogeneous nature of a
  quadtree, the paths found likely won't reflect the 'true' least cost path.
  This is because treating the centroids of the cells as the nodes introduces
  some distortion, especially with large cells.</p>
<p>Also note that the <code>xlim</code> and <code>ylim</code> arguments in
  <code>lcp_finder()</code> can be used to restrict the search space to the
  rectangle defined by xlim and ylim. This speeds up the computation of the
  LCP by limiting the number of cells considered.</p>
<p>Another note is that an LcpFinder object is specific to a given
  starting point. If a new starting point is used, a new LCP finder is
  needed.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='find_lcp.html'>find_lcp</a>()</code> returns the LCP between two points.
  <code><a href='find_lcps.html'>find_lcps</a>()</code> finds all LCPs whose cost-distance is less
  than some value. <code><a href='summarize_lcps.html'>summarize_lcps</a>()</code> outputs a summary matrix of
  all LCPs that have been calculated so far.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://rspatial.org/raster'>raster</a></span><span class='op'>)</span>

<span class='co'>#####################################</span>
<span class='co'># create a quadtree</span>
<span class='co'>#####################################</span>

<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>habitat</span><span class='op'>)</span>
<span class='va'>rast</span> <span class='op'>&lt;-</span> <span class='va'>habitat</span>
<span class='va'>qt</span> <span class='op'>&lt;-</span> <span class='fu'><a href='quadtree.html'>quadtree</a></span><span class='op'>(</span><span class='va'>rast</span>, split_threshold <span class='op'>=</span> <span class='fl'>.1</span>, adj_type <span class='op'>=</span> <span class='st'>"expand"</span><span class='op'>)</span>
<span class='fu'><a href='plot.html'>plot</a></span><span class='op'>(</span><span class='va'>qt</span>, crop <span class='op'>=</span> <span class='cn'>TRUE</span>, na_col <span class='op'>=</span> <span class='cn'>NULL</span>, border_lwd <span class='op'>=</span> <span class='fl'>.4</span><span class='op'>)</span>
</div><div class='img'><img src='lcp_finder-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>#####################################</span>
<span class='co'># basic usage</span>
<span class='co'>#####################################</span>

<span class='co'># --------------------</span>
<span class='co'># find the LCP to a single point</span>
<span class='co'># --------------------</span>
<span class='va'>start_pt1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>6989</span>, <span class='fl'>34007</span><span class='op'>)</span>
<span class='va'>end_pt1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>33015</span>, <span class='fl'>38162</span><span class='op'>)</span>

<span class='co'># create the LCP finder object and find the LCP</span>
<span class='va'>lcpf1</span> <span class='op'>&lt;-</span> <span class='fu'>lcp_finder</span><span class='op'>(</span><span class='va'>qt</span>, <span class='va'>start_pt1</span><span class='op'>)</span>
<span class='va'>path1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='find_lcp.html'>find_lcp</a></span><span class='op'>(</span><span class='va'>lcpf1</span>, <span class='va'>end_pt1</span><span class='op'>)</span>

<span class='co'># plot the LCP</span>
<span class='fu'><a href='plot.html'>plot</a></span><span class='op'>(</span><span class='va'>qt</span>, crop <span class='op'>=</span> <span class='cn'>TRUE</span>, na_col <span class='op'>=</span> <span class='cn'>NULL</span>, border_col <span class='op'>=</span> <span class='st'>"gray30"</span>, border_lwd <span class='op'>=</span> <span class='fl'>.4</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>start_pt1</span>, <span class='va'>end_pt1</span><span class='op'>)</span>, pch <span class='op'>=</span> <span class='fl'>16</span>, col <span class='op'>=</span> <span class='st'>"red"</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>path1</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>]</span>, col <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span>
</div><div class='img'><img src='lcp_finder-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># --------------------</span>
<span class='co'># find all LCPs</span>
<span class='co'># --------------------</span>
<span class='co'># calculate all LCPs</span>
<span class='va'>paths_summary1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='find_lcps.html'>find_lcps</a></span><span class='op'>(</span><span class='va'>lcpf1</span>, limit_type <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in .local(x, ...): unused argument (limit_type = "none")</span></div><div class='input'><span class='co'># retrieve each individual LCP</span>
<span class='va'>all_paths1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/pkg/raster/man/ncell.html'>nrow</a></span><span class='op'>(</span><span class='va'>paths_summary1</span><span class='op'>)</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>i</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>row_i</span> <span class='op'>&lt;-</span> <span class='va'>paths_summary1</span><span class='op'>[</span><span class='va'>i</span>, <span class='op'>]</span>
  <span class='va'>pt_i</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span><span class='op'>(</span><span class='va'>row_i</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>xmin</span> <span class='op'>+</span> <span class='va'>xmax</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>2</span>, <span class='op'>(</span><span class='va'>ymin</span> <span class='op'>+</span> <span class='va'>ymax</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='fu'><a href='find_lcp.html'>find_lcp</a></span><span class='op'>(</span><span class='va'>lcpf1</span>, <span class='va'>pt_i</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'nrow': object 'paths_summary1' not found</span></div><div class='input'>
<span class='co'># plot all the LCPs</span>
<span class='fu'><a href='plot.html'>plot</a></span><span class='op'>(</span><span class='va'>qt</span>, crop <span class='op'>=</span> <span class='cn'>TRUE</span>, na_col <span class='op'>=</span> <span class='cn'>NULL</span>, border_col <span class='op'>=</span> <span class='st'>"gray30"</span>, border_lwd <span class='op'>=</span> <span class='fl'>.4</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/invisible.html'>invisible</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>all_paths1</span>, <span class='va'>lines</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in lapply(all_paths1, lines): object 'all_paths1' not found</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span><span class='va'>start_pt1</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, <span class='va'>start_pt1</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>, bg<span class='op'>=</span><span class='st'>"red"</span>, col<span class='op'>=</span><span class='st'>"black"</span>, pch<span class='op'>=</span><span class='fl'>21</span>, cex<span class='op'>=</span><span class='fl'>1.2</span><span class='op'>)</span>
</div><div class='img'><img src='lcp_finder-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># --------------------</span>
<span class='co'># find all cells reachable under a given threshold</span>
<span class='co'># --------------------</span>
<span class='va'>start_pt2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>19000</span>, <span class='fl'>25000</span><span class='op'>)</span>
<span class='va'>limit</span> <span class='op'>&lt;-</span> <span class='fl'>5000</span>

<span class='co'># create the LCP finder object and find all the valid LCPs</span>
<span class='va'>lcpf2</span> <span class='op'>&lt;-</span> <span class='fu'>lcp_finder</span><span class='op'>(</span><span class='va'>qt</span>, <span class='va'>start_pt2</span><span class='op'>)</span>
<span class='co'># we could use limit_type = "none" if we wanted to find LCPs to ALL cells</span>
<span class='va'>paths_summary2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='find_lcps.html'>find_lcps</a></span><span class='op'>(</span><span class='va'>lcpf2</span>, limit_type <span class='op'>=</span> <span class='st'>"cd"</span>, limit <span class='op'>=</span> <span class='va'>limit</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in .local(x, ...): unused argument (limit_type = "cd")</span></div><div class='input'>
<span class='co'># plot the centroids of the reachable cells</span>
<span class='fu'><a href='plot.html'>plot</a></span><span class='op'>(</span><span class='va'>qt</span>, main <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"reachable cells; cost + distance &lt; "</span>, <span class='va'>limit</span><span class='op'>)</span>,
     crop <span class='op'>=</span> <span class='cn'>TRUE</span>, na_col <span class='op'>=</span> <span class='cn'>NULL</span>, border_col <span class='op'>=</span> <span class='st'>"gray60"</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span><span class='op'>(</span><span class='va'>paths_summary2</span>,
     <span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>xmin</span> <span class='op'>+</span> <span class='va'>xmax</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>2</span>, <span class='op'>(</span><span class='va'>ymin</span> <span class='op'>+</span> <span class='va'>ymax</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>2</span>,
            pch <span class='op'>=</span> <span class='fl'>16</span>, col <span class='op'>=</span> <span class='st'>"black"</span>, cex <span class='op'>=</span> <span class='fl'>.4</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in with(paths_summary2, points((xmin + xmax)/2, (ymin + ymax)/2,     pch = 16, col = "black", cex = 0.4)): object 'paths_summary2' not found</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span><span class='va'>start_pt2</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, <span class='va'>start_pt2</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>, col <span class='op'>=</span> <span class='st'>"red"</span>, pch <span class='op'>=</span> <span class='fl'>16</span><span class='op'>)</span>
</div><div class='img'><img src='lcp_finder-4.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># --------------------</span>
<span class='co'># limiting the search area</span>
<span class='co'># --------------------</span>
<span class='co'># define the search area</span>
<span class='va'>box_length</span> <span class='op'>&lt;-</span> <span class='fl'>7000</span>
<span class='va'>xlim</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>start_pt2</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>box_length</span> <span class='op'>/</span> <span class='fl'>2</span>, <span class='va'>start_pt2</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>+</span> <span class='va'>box_length</span> <span class='op'>/</span> <span class='fl'>2</span><span class='op'>)</span>
<span class='va'>ylim</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>start_pt2</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>box_length</span> <span class='op'>/</span> <span class='fl'>2</span>, <span class='va'>start_pt2</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span> <span class='op'>+</span> <span class='va'>box_length</span> <span class='op'>/</span> <span class='fl'>2</span><span class='op'>)</span>

<span class='co'># find the LCPs to all the cells inside the search area</span>
<span class='va'>lcpf3</span> <span class='op'>&lt;-</span> <span class='fu'>lcp_finder</span><span class='op'>(</span><span class='va'>qt</span>, <span class='va'>start_pt2</span>, xlim <span class='op'>=</span> <span class='va'>xlim</span>, ylim <span class='op'>=</span> <span class='va'>ylim</span><span class='op'>)</span>
<span class='va'>paths_summary3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='find_lcps.html'>find_lcps</a></span><span class='op'>(</span><span class='va'>lcpf3</span>, limit_type <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in .local(x, ...): unused argument (limit_type = "none")</span></div><div class='input'>
<span class='co'># retrive each LCP</span>
<span class='va'>all_paths3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/pkg/raster/man/ncell.html'>nrow</a></span><span class='op'>(</span><span class='va'>paths_summary3</span><span class='op'>)</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>i</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>row_i</span> <span class='op'>&lt;-</span> <span class='va'>paths_summary3</span><span class='op'>[</span><span class='va'>i</span>, <span class='op'>]</span>
  <span class='va'>pt_i</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span><span class='op'>(</span><span class='va'>row_i</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>xmin</span> <span class='op'>+</span> <span class='va'>xmax</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>2</span>, <span class='op'>(</span><span class='va'>ymin</span> <span class='op'>+</span> <span class='va'>ymax</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='fu'><a href='find_lcp.html'>find_lcp</a></span><span class='op'>(</span><span class='va'>lcpf3</span>, <span class='va'>pt_i</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'nrow': object 'paths_summary3' not found</span></div><div class='input'>
<span class='co'># plot the results</span>
<span class='fu'><a href='plot.html'>plot</a></span><span class='op'>(</span><span class='va'>qt</span>, crop <span class='op'>=</span> <span class='cn'>TRUE</span>, na_col <span class='op'>=</span> <span class='cn'>NULL</span>, border_col <span class='op'>=</span> <span class='st'>"gray60"</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span><span class='op'>(</span><span class='va'>paths_summary3</span>,
     <span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>xmin</span> <span class='op'>+</span> <span class='va'>xmax</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>2</span>, <span class='op'>(</span><span class='va'>ymin</span> <span class='op'>+</span> <span class='va'>ymax</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>2</span>,
            pch <span class='op'>=</span> <span class='fl'>16</span>, col <span class='op'>=</span> <span class='st'>"black"</span>, cex <span class='op'>=</span> <span class='fl'>.4</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in with(paths_summary3, points((xmin + xmax)/2, (ymin + ymax)/2,     pch = 16, col = "black", cex = 0.4)): object 'paths_summary3' not found</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/invisible.html'>invisible</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>all_paths3</span>, <span class='va'>lines</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in lapply(all_paths3, lines): object 'all_paths3' not found</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/rect.html'>rect</a></span><span class='op'>(</span><span class='va'>xlim</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, <span class='va'>ylim</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, <span class='va'>xlim</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>, <span class='va'>ylim</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>, border <span class='op'>=</span> <span class='st'>"red"</span>, lwd <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span><span class='va'>start_pt2</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, <span class='va'>start_pt2</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>, col <span class='op'>=</span> <span class='st'>"red"</span>, pch <span class='op'>=</span> <span class='fl'>16</span><span class='op'>)</span>
</div><div class='img'><img src='lcp_finder-5.png' alt='' width='700' height='433' /></div><div class='input'>

<span class='co'>#####################################</span>
<span class='co'># a larger example to demonstrate run time</span>
<span class='co'>#####################################</span>

<span class='co'>#generate a large matrix of random values between 0 and 1</span>
<span class='va'>nrow</span> <span class='op'>&lt;-</span> <span class='fl'>570</span>
<span class='va'>ncol</span> <span class='op'>&lt;-</span> <span class='fl'>750</span>
<span class='va'>rast</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/raster/man/raster.html'>raster</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='va'>nrow</span> <span class='op'>*</span> <span class='va'>ncol</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='va'>nrow</span>, ncol <span class='op'>=</span> <span class='va'>ncol</span><span class='op'>)</span>,
              xmn <span class='op'>=</span> <span class='fl'>0</span>, xmx <span class='op'>=</span> <span class='va'>ncol</span>, ymn <span class='op'>=</span> <span class='fl'>0</span>, ymx <span class='op'>=</span> <span class='va'>nrow</span><span class='op'>)</span>

<span class='co'>#make the quadtree</span>
<span class='va'>qt1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='quadtree.html'>quadtree</a></span><span class='op'>(</span><span class='va'>rast</span>, split_threshold <span class='op'>=</span> <span class='fl'>.9</span>, adj_type <span class='op'>=</span> <span class='st'>"expand"</span><span class='op'>)</span>

<span class='co'>#get the LCP finder</span>
<span class='va'>lcpf</span> <span class='op'>&lt;-</span> <span class='fu'>lcp_finder</span><span class='op'>(</span><span class='va'>qt1</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># the LCP finder saves state. So finding the path the first time requires</span>
<span class='co'># computation, and takes longer, but running it again is nearly instantaneous</span>
<span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span><span class='op'>(</span><span class='fu'><a href='find_lcp.html'>find_lcp</a></span><span class='op'>(</span><span class='va'>lcpf</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>740</span>, <span class='fl'>560</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='co'>#takes longer</span>
</div><div class='output co'>#&gt;    user  system elapsed 
#&gt;   0.133   0.002   0.135 </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span><span class='op'>(</span><span class='fu'><a href='find_lcp.html'>find_lcp</a></span><span class='op'>(</span><span class='va'>lcpf</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>740</span>, <span class='fl'>560</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='co'>#runs MUCH faster</span>
</div><div class='output co'>#&gt;    user  system elapsed 
#&gt;   0.000   0.000   0.001 </div><div class='input'>
<span class='co'># in addition, because of how Dijkstra's algorithm works, the LCP finder also</span>
<span class='co'># found many other LCPs in the course of finding the first LCP, meaning that</span>
<span class='co'># subsequent LCP queries for different destination points will be much faster</span>
<span class='co'># (since the LCP finder saves state)</span>
<span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span><span class='op'>(</span><span class='fu'><a href='find_lcp.html'>find_lcp</a></span><span class='op'>(</span><span class='va'>lcpf</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>740</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;    user  system elapsed 
#&gt;       0       0       0 </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span><span class='op'>(</span><span class='fu'><a href='find_lcp.html'>find_lcp</a></span><span class='op'>(</span><span class='va'>lcpf</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>560</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;    user  system elapsed 
#&gt;   0.000   0.000   0.001 </div><div class='input'>
<span class='co'># now save the paths so we can plot them</span>
<span class='va'>path1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='find_lcp.html'>find_lcp</a></span><span class='op'>(</span><span class='va'>lcpf</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>740</span>, <span class='fl'>560</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>path2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='find_lcp.html'>find_lcp</a></span><span class='op'>(</span><span class='va'>lcpf</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>740</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>path3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='find_lcp.html'>find_lcp</a></span><span class='op'>(</span><span class='va'>lcpf</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>560</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># plot the paths</span>
<span class='fu'><a href='plot.html'>plot</a></span><span class='op'>(</span><span class='va'>qt1</span>, crop <span class='op'>=</span> <span class='cn'>TRUE</span>, border_col <span class='op'>=</span> <span class='st'>"transparent"</span>, na_col <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>path1</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>path2</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>]</span>, col <span class='op'>=</span> <span class='st'>"red"</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>path3</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>]</span>, col <span class='op'>=</span> <span class='st'>"blue"</span><span class='op'>)</span>
</div><div class='img'><img src='lcp_finder-6.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Derek Friend.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


