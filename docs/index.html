<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quadtree Representation of Rasters • quadtree</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Quadtree Representation of Rasters">
<meta property="og:description" content="Provides a C++ implementation of a quadtree data structure. Functions are
  provided for creating a quadtree from a raster, with the level of coarseness of the
  quadtree being determined by a user-supplied parameter. In addition, functions are 
  provided to extract values of the quadtree at point locations. Functions for calculating 
  least-cost paths between two points are also provided.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">quadtree</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/quadtree-architecture.html">Vignette Title</a>
    </li>
    <li>
      <a href="articles/quadtree-creation.html">Quadtree creation</a>
    </li>
    <li>
      <a href="articles/quadtree-lcp.html">Finding Least-Cost Paths on a Quadtree</a>
    </li>
    <li>
      <a href="articles/quadtree-usage.html">Using Quadtrees</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://gitlab.com/dafriend/quadtree/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="quadtree" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#quadtree" class="anchor"></a>quadtree</h1></div>
<p>This package provides functionality for working with raster-like quadtrees, which allow for variable-sized cells.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>The package can be installed with the following R command:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_gitlab</a></span><span class="op">(</span><span class="st">"dafriend/quadtree"</span><span class="op">)</span></code></pre></div>
<p>For documentation of all the functions, see the PDF file stored at the root directory.</p>
</div>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h2>
<p>A quadtree object is created from a raster or matrix:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://gitlab.com/dafriend/quadtree">quadtree</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/edzer/sp/">sp</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/raster">raster</a></span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'raster'</span>
<span class="co">#&gt; The following objects are masked from 'package:quadtree':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     projection, projection&lt;-</span>

<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">habitat</span>, package<span class="op">=</span><span class="st">"quadtree"</span><span class="op">)</span> <span class="co">#load sample data</span>
<span class="va">qt</span> <span class="op">=</span> <span class="fu"><a href="reference/quadtree.html">quadtree</a></span><span class="op">(</span><span class="va">habitat</span>, split_threshold<span class="op">=</span><span class="fl">.03</span>, split_method<span class="op">=</span><span class="st">"sd"</span><span class="op">)</span> <span class="co">#create a quadtree</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="reference/plot.html">plot</a></span><span class="op">(</span><span class="va">habitat</span>, zlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, main<span class="op">=</span><span class="st">"raster representation"</span>, axes<span class="op">=</span><span class="cn">FALSE</span>, box<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="reference/plot.html">plot</a></span><span class="op">(</span><span class="va">qt</span>, crop<span class="op">=</span><span class="cn">TRUE</span>, na_col<span class="op">=</span><span class="cn">NULL</span>, border_lwd<span class="op">=</span><span class="fl">.2</span>,xlab<span class="op">=</span><span class="st">""</span>, ylab<span class="op">=</span><span class="st">""</span>, legend<span class="op">=</span><span class="cn">FALSE</span>, zlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, main<span class="op">=</span><span class="st">"quadtree representation"</span>, axes<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-example_create-1.png" width="100%"></p>
<p>The package allows for flexibility in the quadtree creation process. Several functions defining how to split and aggregate cells are provided, and custom functions can be written for both of these processes. In addition, quadtrees can be created using other quadtrees as “templates”, so that the new quadtree has the identical structure as the template quadtree.</p>
<p>Once created, cell values can be extracted, as with a raster:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pts</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">20000</span>,<span class="fl">32000</span>,<span class="fl">5000</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10000</span>,<span class="fl">30000</span>,<span class="fl">27000</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="reference/extract.html">extract</a></span><span class="op">(</span><span class="va">qt</span>,<span class="va">pts</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.9692383 0.5340000 0.1364531</span></code></pre></div>
<p>In addition, functions are provided for calculating least-cost paths using the quadtree as a resistance surface.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">start_point</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6989</span>,<span class="fl">34007</span><span class="op">)</span>
<span class="va">end_point</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">33015</span>,<span class="fl">38162</span><span class="op">)</span>
<span class="va">lcp_finder</span> <span class="op">=</span> <span class="fu"><a href="reference/lcp_finder.html">lcp_finder</a></span><span class="op">(</span><span class="va">qt</span>, <span class="va">start_point</span><span class="op">)</span>
<span class="va">lcp</span> <span class="op">=</span> <span class="fu"><a href="reference/find_lcp.html">find_lcp</a></span><span class="op">(</span><span class="va">lcp_finder</span>, <span class="va">end_point</span>, use_original_end_points <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="fu"><a href="reference/plot.html">plot</a></span><span class="op">(</span><span class="va">qt</span>, border_col<span class="op">=</span><span class="st">"gray70"</span>, crop<span class="op">=</span><span class="cn">TRUE</span>, na_col<span class="op">=</span><span class="cn">NULL</span>, border_lwd<span class="op">=</span><span class="fl">.5</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">lcp</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">start_point</span>, <span class="va">end_point</span><span class="op">)</span>, col<span class="op">=</span><span class="st">"red"</span>, pch<span class="op">=</span><span class="fl">16</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-example_lcp-1.png" width="70%" height="70%"></p>
</div>
<div id="learning-how-to-use-the-quadtree-package" class="section level2">
<h2 class="hasAnchor">
<a href="#learning-how-to-use-the-quadtree-package" class="anchor"></a>Learning how to use the <code>quadtree</code> package</h2>
<p>Currently there are no vignettes, as this package is still in development, although in the future I hope to add some. However, all of the functions in the package are well documented and have extensive examples that the user can run. To understand the basics of the library, I’d recommend first reading the documentation for <code>quadtree</code> (i.e. run <code><a href="reference/quadtree.html">?quadtree</a></code> in the console) first - this help file contains all the basic info on what a quadtree is and how it is constructed. To learn more about the least-cost path functionality, start with the documentation for <code><a href="reference/lcp_finder.html">?lcp_finder</a></code> and also take a look at <code><a href="reference/find_lcp.html">?find_lcp</a></code> and <code><a href="reference/find_lcps.html">?find_lcps</a></code>.</p>
<p>Most of the other functions are quite simple - take a look at the PDF manual included in the repository for information on how to use them.</p>
</div>
<div id="file-structure" class="section level2">
<h2 class="hasAnchor">
<a href="#file-structure" class="anchor"></a>File structure</h2>
<p>The code here <em>mostly</em> conforms to the standard R package structure. The exception is the ‘other_files’ folder.</p>
<ul>
<li>/R - contains the R files</li>
<li>/data - contains Rdata files (.rda) containing sample data</li>
<li>/man - contains the documentation files</li>
<li>/other_files - contains ‘scratchwork’ scripts that I use to test the package functionality. This folder is ignored when the package is built.</li>
<li>/src - contains the C++ code</li>
<li>/tests - contains unit tests</li>
</ul>
</div>
<div id="implementation-details" class="section level2">
<h2 class="hasAnchor">
<a href="#implementation-details" class="anchor"></a>Implementation Details</h2>
<p>The bulk of the code is written in C++ and interfaced with R via Rcpp.</p>
<p>The overall design philosophy was to keep the core C++ code completely independent from the R code (i.e. no Rcpp-related code in the core C++ files.) This results in a three-tiered organization of the code - core C++ code, Rcpp C++ code, and R code.</p>
<div id="core-c-code" class="section level3">
<h3 class="hasAnchor">
<a href="#core-c-code" class="anchor"></a>Core C++ code</h3>
<p>This consists of the following files (only the .h files are listed to avoid redundancy, but each of these files has a corresponding .cpp file):</p>
<ul>
<li>Matrix.h - Defines the Matrix class implementing basic matrix funcitonality</li>
<li>Node.h - Defines the Node class, which are the ‘nodes’ of the quadtree</li>
<li>Point.h - Defines a simple Point class</li>
<li>PointUtilities.h - Defines a namespace containing functions for performing calculations with Point objects</li>
<li>Quadtree.h - Defines the Quadtree class, which can be seen as a wrapper that provides a link to the interconnected nodes that make up the quadtree</li>
<li>ShortestPathFinder.h - Defines a class for finding the least-cost paths using a quadtree as a cost surface</li>
</ul>
<p>As mentioned before, these files are completely independent of R and can be built and run independently of R.</p>
</div>
<div id="rcpp-c-code" class="section level3">
<h3 class="hasAnchor">
<a href="#rcpp-c-code" class="anchor"></a>Rcpp C++ code</h3>
<p>These files are called ‘wrappers’ - essentially they each contain an instance of the relevant object and provide additional Rcpp-related functions that can be accessed from R. These essentially provide the “bridge” that allows the functionality in the core C++ files to be accessed from R.</p>
<ul>
<li>NodeWrapper.h - wrapper class for ‘Node’. This class is exposed to R as ‘CppNode’.</li>
<li>QuadtreeWrapper.h - wrapper class for ‘Quadtree’. This class is exposed to R as ‘CppQuadtree’.</li>
<li>ShortestPathFinderWrapper.h - wrapper class for ‘ShortestPathFinder’. This class is exposed to R as ‘CppShortestPathFinder’.</li>
<li>R_Interface.h - defines a namespace that currently contains only a single function, which converts an Rcpp matrix to the Matrix class I created. This function is separate from the other files because it is a general-purpose function and thus didn’t fit in any of the wrapper classes.</li>
<li>load_modules.cpp - contains code that exposes the wrapper classes to R using Rcpp modules.</li>
</ul>
</div>
<div id="r-code" class="section level3">
<h3 class="hasAnchor">
<a href="#r-code" class="anchor"></a>R code</h3>
<p>Almost all of the core functionality of the quadtree package is contained in the C++ code, and the R code serves primarily as an interface for working with the C++ quadtree data structure. A Quadtree S4 class is defined which consists only of one slot, which contains a ‘CppQuadtree’ object. The methods for this class are often quite simple, merely consisting of calling one of the methods on the CppQuadtree object. Using this approach has a few benefits. First, wrapping the C++ class in an S4 class allows the quadtree functionality to be accessed in a way that is much more consistent with typical R syntax, which will hopefully be more intuitive to R users. Second, it allows for me to add R code to validate and make any necessary modifications to parameters before calling the C++ methods - this helps make the functions more robust. This also allows me to take advantage of existing R functionality (for example, resampling a raster from the ‘raster’ package).</p>
<p>I won’t discuss each R file/function here - see the documentation PDF for details on each R function.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://gitlab.com/dafriend/quadtree/">https://​gitlab.com/​dafriend/​quadtree/​</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Derek Friend <br><small class="roles"> Author, maintainer </small>  </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Derek Friend.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
