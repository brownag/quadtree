<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using Quadtrees • quadtree</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Using Quadtrees">
<meta property="og:description" content="quadtree">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">quadtree</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/quadtree-creation.html">Creating Quadtrees</a>
    </li>
    <li>
      <a href="../articles/quadtree-usage.html">Using Quadtrees</a>
    </li>
    <li>
      <a href="../articles/quadtree-lcp.html">Finding LCPs</a>
    </li>
    <li>
      <a href="../articles/quadtree-code.html">Code Details</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dfriend21/quadtree/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="quadtree-usage_files/header-attrs-2.11/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Using Quadtrees</h1>
                        <h4 class="author">Derek Friend</h4>
            
            <h4 class="date">Last compiled on December 03, 2021</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/dfriend21/quadtree/blob/master/vignettes/quadtree-usage.Rmd"><code>vignettes/quadtree-usage.Rmd</code></a></small>
      <div class="hidden name"><code>quadtree-usage.Rmd</code></div>

    </div>

    
    
<div id="vignette-content" class="section level2">
<h2 class="hasAnchor">
<a href="#vignette-content" class="anchor"></a>Vignette content</h2>
<p>This vignette covers ways of interacting with a <code>Quadtree</code> object after it has been created - for example, extracting values and modifying values.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/raster">raster</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dfriend21/quadtree/">quadtree</a></span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">habitat</span><span class="op">)</span>
<span class="va">rast</span> <span class="op">&lt;-</span> <span class="va">habitat</span>

<span class="va">qt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/quadtree.html">quadtree</a></span><span class="op">(</span><span class="va">rast</span>, <span class="fl">.15</span><span class="op">)</span></code></pre></div>
</div>
<div id="retrieving-basic-info-about-a-quadtree" class="section level2">
<h2 class="hasAnchor">
<a href="#retrieving-basic-info-about-a-quadtree" class="anchor"></a>Retrieving basic info about a quadtree</h2>
<p>There are a number of functions for retrieving basic info about a <code>Quadtree</code>.</p>
<div id="getting-a-summary-of-a-quadtree" class="section level3">
<h3 class="hasAnchor">
<a href="#getting-a-summary-of-a-quadtree" class="anchor"></a>Getting a summary of a quadtree</h3>
<p>A basic summary of a quadtree can be shown by just typing the variable name or using the <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> function:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">qt</span>
<span class="co">#&gt; class         : Quadtree</span>
<span class="co">#&gt; # of cells    : 4210</span>
<span class="co">#&gt; min cell size : 250</span>
<span class="co">#&gt; extent        : 0, 64000, 0, 64000 (xmin, xmax, ymin, ymax)</span>
<span class="co">#&gt; crs           : NA</span>
<span class="co">#&gt; values        : 0.109, 0.974 (min, max)</span></code></pre></div>
</div>
<div id="getting-the-projection-of-a-quadtree" class="section level3">
<h3 class="hasAnchor">
<a href="#getting-the-projection-of-a-quadtree" class="anchor"></a>Getting the projection of a quadtree</h3>
<p><code><a href="../reference/projection.html">projection()</a></code> can be used to get and set the projection of the <code>Quadtree</code>. In this case there is no projection, so an empty string is returned.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/projection.html">projection</a></span><span class="op">(</span><span class="va">qt</span><span class="op">)</span>
<span class="co">#&gt; [1] ""</span></code></pre></div>
</div>
<div id="getting-the-number-of-cells-in-a-quadtree" class="section level3">
<h3 class="hasAnchor">
<a href="#getting-the-number-of-cells-in-a-quadtree" class="anchor"></a>Getting the number of cells in a quadtree</h3>
<p><code><a href="../reference/n_cells.html">n_cells()</a></code> returns the number of cells in the quadtree. It has one optional parameter, <code>terminal_only</code> - if <code>TRUE</code>, the number of cells of the quadtree that are terminal (i.e. have no children) is returned. If <code>FALSE</code>, the total number of nodes in the quadtree is returned.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/n_cells.html">n_cells</a></span><span class="op">(</span><span class="va">qt</span><span class="op">)</span>
<span class="co">#&gt; [1] 4210</span>
<span class="fu"><a href="../reference/n_cells.html">n_cells</a></span><span class="op">(</span><span class="va">qt</span>, terminal_only <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; [1] 5613</span></code></pre></div>
</div>
<div id="getting-the-extent-of-a-quadtree" class="section level3">
<h3 class="hasAnchor">
<a href="#getting-the-extent-of-a-quadtree" class="anchor"></a>Getting the extent of a quadtree</h3>
<p><code><a href="../reference/extent.html">extent()</a></code> can be used to return the extent of the quadtree. It has one optional parameter <code>original</code> - if <code>FALSE</code> (the default), it returns the total extent covered by the quadtree. If <code>TRUE</code>, the function returns the extent of the original raster used to create the quadtree, before <code>NA</code> rows/columns were added to pad the dimensions. You may need to preface <code><a href="../reference/extent.html">extent()</a></code> with <code>quadtree::</code> to avoid conflicts with the <code>raster</code> package.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">quadtree</span><span class="fu">::</span><span class="fu"><a href="../reference/extent.html">extent</a></span><span class="op">(</span><span class="va">qt</span><span class="op">)</span>
<span class="co">#&gt; class      : Extent </span>
<span class="co">#&gt; xmin       : 0 </span>
<span class="co">#&gt; xmax       : 64000 </span>
<span class="co">#&gt; ymin       : 0 </span>
<span class="co">#&gt; ymax       : 64000</span>
<span class="fu">quadtree</span><span class="fu">::</span><span class="fu"><a href="../reference/extent.html">extent</a></span><span class="op">(</span><span class="va">qt</span>, original <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; class      : Extent </span>
<span class="co">#&gt; xmin       : 0 </span>
<span class="co">#&gt; xmax       : 40250 </span>
<span class="co">#&gt; ymin       : 0 </span>
<span class="co">#&gt; ymax       : 44500</span></code></pre></div>
</div>
</div>
<div id="retrieving-cell-level-data" class="section level2">
<h2 class="hasAnchor">
<a href="#retrieving-cell-level-data" class="anchor"></a>Retrieving cell-level data</h2>
<div id="extracting-values" class="section level3">
<h3 class="hasAnchor">
<a href="#extracting-values" class="anchor"></a>Extracting values</h3>
<p>Values can be ‘extracted’ at point locations using the <code><a href="../reference/extract.html">extract()</a></code> function. This function has one optional parameter - <code>extents</code>. If <code>extents</code> is <code>FALSE</code> (the default), then only the values at the point locations are returned. If <code>extents</code> is <code>TRUE</code>, then a matrix is returned that also returns the x and y limits of each cell in addition to the cell value.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5609</span>, <span class="fl">3959</span>, <span class="fl">20161</span>, <span class="fl">27662</span>, <span class="fl">32763</span><span class="op">)</span>,
             y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10835</span>, <span class="fl">29586</span>, <span class="fl">31836</span>, <span class="fl">10834</span>, <span class="fl">36337</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">qt</span>, crop <span class="op">=</span> <span class="cn">TRUE</span>, border_lwd <span class="op">=</span> <span class="fl">.3</span>, na_col <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">pts</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></code></pre></div>
<p><img src="quadtree-usage_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">quadtree</span><span class="fu">::</span><span class="fu"><a href="../reference/extract.html">extract</a></span><span class="op">(</span><span class="va">qt</span>, <span class="va">pts</span><span class="op">)</span>
<span class="co">#&gt; [1]       NaN 0.1451094 0.8202500 0.9556426 0.6800000</span>
<span class="fu">quadtree</span><span class="fu">::</span><span class="fu"><a href="../reference/extract.html">extract</a></span><span class="op">(</span><span class="va">qt</span>, <span class="va">pts</span>, extents <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt;        id  xmin  xmax  ymin  ymax     value</span>
<span class="co">#&gt; [1,] 4339     0  8000  8000 16000       NaN</span>
<span class="co">#&gt; [2,] 1826  2000  4000 28000 30000 0.1451094</span>
<span class="co">#&gt; [3,] 3394 20000 21000 31000 32000 0.8202500</span>
<span class="co">#&gt; [4,] 4569 24000 32000  8000 16000 0.9556426</span>
<span class="co">#&gt; [5,] 1567 32500 33000 36000 36500 0.6800000</span></code></pre></div>
</div>
<div id="retrieving-neighbor-relationships" class="section level3">
<h3 class="hasAnchor">
<a href="#retrieving-neighbor-relationships" class="anchor"></a>Retrieving neighbor relationships</h3>
<p>In addition to extracting values from cells, it is possible to determine neighbor relationships between cells via the <code><a href="../reference/get_neighbors.html">get_neighbors()</a></code> function. Given a point, <code><a href="../reference/get_neighbors.html">get_neighbors()</a></code> returns the cells that neighbor the cell that the point falls in. Note that cells that are diagonal from each either (i.e. only touch at the corner) are considered to be neighbors.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/get_neighbors.html">get_neighbors</a></span><span class="op">(</span><span class="va">qt</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">pts</span><span class="op">[</span><span class="fl">3</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;        id  xmin  xmax  ymin  ymax     value</span>
<span class="co">#&gt; [1,]  975 19500 20000 32000 32500 0.8557500</span>
<span class="co">#&gt; [2,] 1047 21000 22000 32000 33000 0.7893750</span>
<span class="co">#&gt; [3,] 1046 20000 21000 32000 33000 0.8236875</span>
<span class="co">#&gt; [4,] 3295 19000 20000 31000 32000 0.9098125</span>
<span class="co">#&gt; [5,] 3301 19000 20000 30000 31000 0.9466250</span>
<span class="co">#&gt; [6,] 3396 20000 21000 30000 31000 0.8688750</span>
<span class="co">#&gt; [7,] 3395 21000 22000 31000 32000 0.8061875</span>
<span class="co">#&gt; [8,] 3397 21000 22000 30000 31000 0.8125625</span></code></pre></div>
</div>
</div>
<div id="copying-a-quadtree" class="section level2">
<h2 class="hasAnchor">
<a href="#copying-a-quadtree" class="anchor"></a>Copying a quadtree</h2>
<p>A key concept to understand is that <code>Quadtree</code> objects are <em>pointers</em> to C++ objects, and copying these objects simply by assigning them to a new variable makes a <em>shallow</em> copy rather than a <em>deep</em> copy. This is important to note because this differs from how R objects normally behave. For example, if I have a data frame named <code>df1</code>, I can make a copy of it by doing <code>df2 &lt;- df1</code>. This makes a <em>deep</em> copy of <code>df1</code> - if I were to modify <code>df2</code>, <code>df1</code> would remain unchanged. This is not the case with <code>Quadtree</code> objects. The R object that users interact with is a pointer to a C++ object. If I were to attempt to make copy of a quadtree <code>qt1</code> by doing <code>qt2 &lt;- qt1</code>, this simply copies the <em>pointer</em> to the C++ object, so <code>qt1</code> and <code>qt2</code> point to the same object. Thus, if <code>qt2</code> is modified (for example, by using a function like <code><a href="../reference/set_values.html">set_values()</a></code> or <code><a href="../reference/transform_values.html">transform_values()</a></code>), <code>qt1</code> will also be modified.</p>
<p>The <code><a href="../reference/copy.html">copy()</a></code> function can be used to make a deep copy of a <code>Quadtree</code> object. This is useful if the user wishes to make changes to a quadtree without modifying the original.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">qt_copy</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/copy.html">copy</a></span><span class="op">(</span><span class="va">qt</span><span class="op">)</span>
<span class="va">qt</span>
<span class="co">#&gt; class         : Quadtree</span>
<span class="co">#&gt; # of cells    : 4210</span>
<span class="co">#&gt; min cell size : 250</span>
<span class="co">#&gt; extent        : 0, 64000, 0, 64000 (xmin, xmax, ymin, ymax)</span>
<span class="co">#&gt; crs           : NA</span>
<span class="co">#&gt; values        : 0.109, 0.974 (min, max)</span>
<span class="va">qt_copy</span>
<span class="co">#&gt; class         : Quadtree</span>
<span class="co">#&gt; # of cells    : 4210</span>
<span class="co">#&gt; min cell size : 250</span>
<span class="co">#&gt; extent        : 0, 64000, 0, 64000 (xmin, xmax, ymin, ymax)</span>
<span class="co">#&gt; crs           : NA</span>
<span class="co">#&gt; values        : 0.109, 0.974 (min, max)</span></code></pre></div>
<p>In the next section (“Modifying cell values”), this function is used in the examples to create copies of a quadtree before modifying it so that the original remains unchanged.</p>
</div>
<div id="modifying-cell-values" class="section level2">
<h2 class="hasAnchor">
<a href="#modifying-cell-values" class="anchor"></a>Modifying cell values</h2>
<p>Two functions are provided for modifying cell values: <code><a href="../reference/set_values.html">set_values()</a></code> and <code><a href="../reference/transform_values.html">transform_values()</a></code>.</p>
<div id="setting-values-of-cells" class="section level3">
<h3 class="hasAnchor">
<a href="#setting-values-of-cells" class="anchor"></a>Setting values of cells</h3>
<p><code><a href="../reference/set_values.html">set_values()</a></code> takes a matrix of points and associated values and changes the values of the cells the points fall in. Note that only the values of the <em>terminal cells</em> that the point falls in are changed.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">qt2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/copy.html">copy</a></span><span class="op">(</span><span class="va">qt</span><span class="op">)</span>
<span class="fu"><a href="../reference/set_values.html">set_values</a></span><span class="op">(</span><span class="va">qt2</span>, <span class="va">pts</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/pkg/raster/man/ncell.html">nrow</a></span><span class="op">(</span><span class="va">pts</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">qt2</span>, crop <span class="op">=</span> <span class="cn">TRUE</span>, border_lwd <span class="op">=</span> <span class="fl">.3</span><span class="op">)</span></code></pre></div>
<p><img src="quadtree-usage_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
</div>
<div id="transforming-all-cell-values" class="section level3">
<h3 class="hasAnchor">
<a href="#transforming-all-cell-values" class="anchor"></a>Transforming all cell values</h3>
<p><code><a href="../reference/transform_values.html">transform_values()</a></code> uses a function to change all cell values. For example, we could use this function to cube all of the cell values:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">qt3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/copy.html">copy</a></span><span class="op">(</span><span class="va">qt</span><span class="op">)</span>
<span class="fu"><a href="../reference/transform_values.html">transform_values</a></span><span class="op">(</span><span class="va">qt3</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">^</span><span class="fl">3</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">qt</span>, crop <span class="op">=</span> <span class="cn">TRUE</span>, na_col <span class="op">=</span> <span class="cn">NULL</span>, border_lwd <span class="op">=</span> <span class="fl">.3</span>, zlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,
     legend <span class="op">=</span> <span class="cn">FALSE</span>, main <span class="op">=</span> <span class="st">"original quadtree"</span><span class="op">)</span>
<span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">qt3</span>, crop <span class="op">=</span> <span class="cn">TRUE</span>, na_col <span class="op">=</span> <span class="cn">NULL</span>, border_lwd <span class="op">=</span> <span class="fl">.3</span>, zlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,
     legend <span class="op">=</span> <span class="cn">FALSE</span>, main <span class="op">=</span> <span class="st">"values cubed"</span><span class="op">)</span></code></pre></div>
<p><img src="quadtree-usage_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
</div>
</div>
<div id="reading-and-writing-quadtrees" class="section level2">
<h2 class="hasAnchor">
<a href="#reading-and-writing-quadtrees" class="anchor"></a>Reading and writing quadtrees</h2>
<p>One of the disadvantages of using C++ classes via Rcpp is that the objects are not preserved between sessions. For example, we could save a <code>Quadtree</code> to a <code>RData</code> file using <code><a href="https://rdrr.io/r/base/save.html">save()</a></code>, but when we loaded it back in we would get an error.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">qt_temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/copy.html">copy</a></span><span class="op">(</span><span class="va">qt</span><span class="op">)</span>
<span class="va">filepath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempfile</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/save.html">save</a></span><span class="op">(</span><span class="va">qt_temp</span>, file <span class="op">=</span> <span class="va">filepath</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="va">filepath</span><span class="op">)</span>
<span class="va">qt_temp</span>
<span class="co">#&gt; Error in (function (cond) : error in evaluating the argument 'x' in selecting a method for function 'extent': external pointer is not valid</span></code></pre></div>
<p>The <code>quadtree</code> package provides read and write functionality via the <code>cereal</code> C++ library, which is used to serialize C++ objects. <code><a href="../reference/read_quadtree.html">read_quadtree()</a></code> and <code><a href="../reference/read_quadtree.html">write_quadtree()</a></code> can be used to read and write <code>Quadtree</code> objects.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">filepath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempfile</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/read_quadtree.html">write_quadtree</a></span><span class="op">(</span><span class="va">filepath</span>, <span class="va">qt</span><span class="op">)</span>
<span class="va">qt_read</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_quadtree.html">read_quadtree</a></span><span class="op">(</span><span class="va">filepath</span><span class="op">)</span>
<span class="va">qt_read</span>
<span class="co">#&gt; class         : Quadtree</span>
<span class="co">#&gt; # of cells    : 4210</span>
<span class="co">#&gt; min cell size : 250</span>
<span class="co">#&gt; extent        : 0, 64000, 0, 64000 (xmin, xmax, ymin, ymax)</span>
<span class="co">#&gt; crs           : NA</span>
<span class="co">#&gt; values        : 0.109, 0.974 (min, max)</span></code></pre></div>
</div>
<div id="converting-quadtrees-to-other-data-types" class="section level2">
<h2 class="hasAnchor">
<a href="#converting-quadtrees-to-other-data-types" class="anchor"></a>Converting quadtrees to other data types</h2>
<p>Functions are also provided for converting a <code>Quadtree</code> to different data types.</p>
<div id="get-all-cell-values-as-a-vector" class="section level3">
<h3 class="hasAnchor">
<a href="#get-all-cell-values-as-a-vector" class="anchor"></a>Get all cell values as a vector</h3>
<p><code><a href="../reference/as_vector.html">as_vector()</a></code> returns the cell values as a numeric vector. It has one optional parameter - <code>terminal_only</code>. If <code>TRUE</code> (the default), only the values of the terminal cells are returned. If <code>FALSE</code>, the values of all cells (including those with children) are returned.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">vec1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_vector.html">as_vector</a></span><span class="op">(</span><span class="va">qt</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">vec1</span><span class="op">)</span>
<span class="co">#&gt; [1] 4210</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">vec1</span><span class="op">)</span>
<span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's </span>
<span class="co">#&gt;  0.1090  0.4850  0.6275  0.6363  0.8139  0.9740     832</span>

<span class="va">vec2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_vector.html">as_vector</a></span><span class="op">(</span><span class="va">qt</span>, <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">vec2</span><span class="op">)</span>
<span class="co">#&gt; [1] 5613</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">vec2</span><span class="op">)</span>
<span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's </span>
<span class="co">#&gt;  0.1090  0.4917  0.6323  0.6446  0.8312  0.9740     832</span></code></pre></div>
</div>
<div id="convert-to-a-data-frame" class="section level3">
<h3 class="hasAnchor">
<a href="#convert-to-a-data-frame" class="anchor"></a>Convert to a data frame</h3>
<p><code><a href="../reference/as_data_frame.html">as_data_frame()</a></code> converts the quadtree to a data frame. In the resulting data frame, each row represents a single cell and has columns describing the cell ID, x and y limits, value, level (i.e. node depth), the size of its smallest child, the ID of its parent, and whether it has children. As with <code><a href="../reference/as_vector.html">as_vector()</a></code>, there is one optional parameter called <code>terminal_only</code> - when <code>TRUE</code> (the default) only the terminal cells are returned, and when <code>FALSE</code>, all cells are returned.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_data_frame.html">as_data_frame</a></span><span class="op">(</span><span class="va">qt</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/dimensions.html">dim</a></span><span class="op">(</span><span class="va">df1</span><span class="op">)</span>
<span class="co">#&gt; [1] 4210   10</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/headtail.html">head</a></span><span class="op">(</span><span class="va">df1</span><span class="op">)</span>
<span class="co">#&gt;    id hasChildren level  xmin  xmax  ymin  ymax value smallestChildLength</span>
<span class="co">#&gt; 3   2           0     2     0 16000 48000 64000   NaN               16000</span>
<span class="co">#&gt; 4   3           0     2 16000 32000 48000 64000   NaN               16000</span>
<span class="co">#&gt; 7   6           0     4     0  4000 44000 48000   NaN                4000</span>
<span class="co">#&gt; 9   8           0     5  4000  6000 46000 48000   NaN                2000</span>
<span class="co">#&gt; 10  9           0     5  6000  8000 46000 48000   NaN                2000</span>
<span class="co">#&gt; 11 10           0     5  4000  6000 44000 46000   NaN                2000</span>
<span class="co">#&gt;    parentID</span>
<span class="co">#&gt; 3         1</span>
<span class="co">#&gt; 4         1</span>
<span class="co">#&gt; 7         5</span>
<span class="co">#&gt; 9         7</span>
<span class="co">#&gt; 10        7</span>
<span class="co">#&gt; 11        7</span>

<span class="va">df2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_data_frame.html">as_data_frame</a></span><span class="op">(</span><span class="va">qt</span>, <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/dimensions.html">dim</a></span><span class="op">(</span><span class="va">df2</span><span class="op">)</span>
<span class="co">#&gt; [1] 5613   10</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/headtail.html">head</a></span><span class="op">(</span><span class="va">df2</span><span class="op">)</span>
<span class="co">#&gt;   id hasChildren level  xmin  xmax  ymin  ymax     value smallestChildLength</span>
<span class="co">#&gt; 1  0           1     0     0 64000     0 64000 0.7559473                 250</span>
<span class="co">#&gt; 2  1           1     1     0 32000 32000 64000 0.7309282                 250</span>
<span class="co">#&gt; 3  2           0     2     0 16000 48000 64000       NaN               16000</span>
<span class="co">#&gt; 4  3           0     2 16000 32000 48000 64000       NaN               16000</span>
<span class="co">#&gt; 5  4           1     2     0 16000 32000 48000 0.8131046                 250</span>
<span class="co">#&gt; 6  5           1     3     0  8000 40000 48000 0.9623516                 250</span>
<span class="co">#&gt;   parentID</span>
<span class="co">#&gt; 1       -1</span>
<span class="co">#&gt; 2        0</span>
<span class="co">#&gt; 3        1</span>
<span class="co">#&gt; 4        1</span>
<span class="co">#&gt; 5        1</span>
<span class="co">#&gt; 6        4</span></code></pre></div>
</div>
<div id="convert-to-a-raster" class="section level3">
<h3 class="hasAnchor">
<a href="#convert-to-a-raster" class="anchor"></a>Convert to a raster</h3>
<p>A <code>Quadtree</code> can also be converted to a raster using the <code><a href="../reference/as_raster.html">as_raster()</a></code> function. This function has one optional parameter named <code>rast</code>, which is used as the template for the output raster. If <code>NULL</code> (the default), a raster is automatically created, where the quadtree extent is used as the raster extent and the smallest cell in the quadtree is used to determine the resolution of the raster. Note that the value of a raster cell is determined by the value of the quadtree cell located at the centroid of the raster cell - thus, if a raster cell overlaps several quadtree cells, whichever quadtree cell the centroid of the raster cell falls in will determine the raster cell’s value. If the default value for <code>rast</code> is used, the raster cells will never overlap with more than one quadtree cell.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rast</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_raster.html">as_raster</a></span><span class="op">(</span><span class="va">qt</span><span class="op">)</span>
<span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">rast</span><span class="op">)</span></code></pre></div>
<p><img src="quadtree-usage_files/figure-html/unnamed-chunk-16-1.png" width="672"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Derek Friend.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
