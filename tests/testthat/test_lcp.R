test_that("qt_find_lcp() finds the correct path in a trivial example", {
  mat = rbind(c(0,1,1,1),c(1,0,0,1),c(1,1,1,0),c(0,0,0,1))
  qt = qt_create(mat,0)
  lcpf = expect_error(qt_lcp_finder(qt,c(.5,.5)),NA)
  lcp = expect_error(qt_find_lcp(lcpf,c(.5,3.5)),NA)
  lcp_expected = rbind(c(0.5,0.5),
                       c(1.5,0.5),
                       c(2.5,0.5),
                       c(3.5,1.5),
                       c(2.5,2.5),
                       c(1.5,2.5),
                       c(0.5,3.5))
  expect_equal(nrow(lcp), nrow(lcp_expected))
  expect_true(all(lcp[,1:2] == lcp_expected))
})


test_that("qt_find_lcps() works with all limit_types",{
  data(habitat)
  
  start_point = c(6989,34007)
  end_point = c(33015,38162)
  
  qt = qt_create(habitat,.2)
  
  lcpf = expect_error(qt_lcp_finder(qt,start_point),NA)
  lcp = expect_error(qt_find_lcps(lcpf,"none"),NA)
  
  lcpf = expect_error(qt_lcp_finder(qt,start_point),NA)
  lcp = expect_error(qt_find_lcps(lcpf,"n"),NA)
  
  lcpf = expect_error(qt_lcp_finder(qt,start_point),NA)
  lcp = expect_error(qt_find_lcps(lcpf,"costdistance",3000),NA)
  
  lcpf = expect_error(qt_lcp_finder(qt,start_point),NA)
  lcp = expect_error(qt_find_lcps(lcpf,"cd",3000),NA)
  
  lcpf = expect_error(qt_lcp_finder(qt,start_point),NA)
  lcp = expect_error(qt_find_lcps(lcpf,"costdistance+distance",6000),NA)
  
  lcpf = expect_error(qt_lcp_finder(qt,start_point),NA)
  lcp = expect_error(qt_find_lcps(lcpf,"cd+d",6000),NA)
})

test_that("qt_lcp_summary() runs without errors and produces expected output",{

})

test_that("qt_find_lcps() finds the same paths as in previous runs", {
  #use qt_lcp_summary() to summarize all paths found by a 'lcpf', then 'dput()'
  #the results and use that for comparison
})
test_that("qt_find_lcp() finds the same path as in previous runs", {
  #basically I'm just including this so I that I get alerted if the output
  #ever changes from what I'm getting right now - doesn't guarantee 
  #its correctness, but is still useful to know
  
  data(habitat)
  qt = qt_create(habitat,.1)
  start_point = c(6989,34007)
  end_point = c(33015,38162)
  
  lcpf = qt_lcp_finder(qt,start_point)
  lcp = qt_find_lcp(lcpf,end_point)
  
  # qt_plot(qt, crop=TRUE, na_col=NULL, border_lwd=.3)
  # points(rbind(start_point,end_point),col="red",pch=16)
  # lines(lcp)
  
  #there's probably a much more graceful way to do this
  #dput(lcp)
  lcp_prev = structure(c(6875, 6625, 6250, 5875, 5625, 5250, 5250, 5250, 5250, 
                         5250, 5250, 5250, 5250, 5500, 6250, 6750, 7250, 7750, 8250, 8750, 
                         9250, 9750, 10250, 10625, 10875, 11125, 11375, 11750, 12250, 
                         12750, 13125, 13375, 13750, 14250, 14750, 15125, 15375, 15750, 
                         16250, 16750, 17125, 17375, 17625, 17875, 18125, 18375, 18750, 
                         19125, 19375, 19750, 20125, 20375, 20750, 21125, 21375, 21625, 
                         21875, 21875, 21875, 21875, 21875, 22125, 22375, 22625, 22875, 
                         22875, 22875, 23125, 23375, 23625, 23875, 24250, 24750, 25125, 
                         25375, 25750, 26250, 26750, 27125, 27375, 27750, 28250, 28625, 
                         28875, 29250, 29625, 29625, 29875, 30125, 30250, 30250, 30625, 
                         30875, 31125, 31375, 31625, 31875, 32125, 32375, 32625, 32875, 
                         33250, 34125, 33875, 33750, 33375, 33125, 32750, 32250, 31750, 
                         31250, 30750, 30250, 29750, 29250, 28500, 27750, 27250, 26750, 
                         26750, 26750, 26750, 26750, 26750, 27250, 27375, 27375, 27375, 
                         27375, 27750, 27750, 27750, 27625, 27625, 27750, 27750, 27750, 
                         27375, 27125, 26750, 26250, 26250, 26125, 26125, 26125, 26125, 
                         26125, 26125, 26250, 26375, 26375, 26750, 26875, 26875, 27250, 
                         27625, 27625, 27875, 28125, 28375, 28625, 28875, 29125, 29375, 
                         29625, 29875, 30125, 30375, 30625, 30875, 31125, 31375, 31625, 
                         31750, 32250, 32375, 32375, 32750, 32750, 32750, 33125, 33125, 
                         33250, 33750, 33875, 34125, 34250, 34625, 34875, 35125, 35375, 
                         35750, 36250, 36625, 36875, 37125, 37375, 37625, 37625, 37625, 
                         37875, 37875, 37875, 38250, 0, 174.478596234732, 341.552262899764, 
                         529.465888862124, 631.64282034516, 758.568486640915, 856.005987594589, 
                         929.005986521705, 988.693481753334, 1045.00597945855, 1110.13097919033, 
                         1180.13098321365, 1258.06848562764, 1391.27943107267, 1590.15321064721, 
                         1745.1863678705, 1875.6475699688, 1977.3975712801, 2114.71007294903, 
                         2269.64757494579, 2428.52257467757, 2590.64757727037, 2840.69821243029, 
                         2988.73233008788, 3088.98232835935, 3201.35732698844, 3331.10732543872, 
                         3626.6779610073, 3909.80296294445, 4195.11546465808, 4406.5269057586, 
                         4521.52690784476, 4690.90640369812, 4886.28140289346, 5059.15640119473, 
                         5238.3195774946, 5360.82583062262, 5564.64936506224, 5814.6999949538, 
                         5976.32498908274, 6107.88891059363, 6192.88890403712, 6282.63890338147, 
                         6388.76390797102, 6499.88890779221, 6576.01390373909, 6658.49664434544, 
                         6746.51337029162, 6809.63836969558, 6964.31797808013, 7080.00463072549, 
                         7148.87963060628, 7288.97516500062, 7427.30292359115, 7499.17792210103, 
                         7618.14864469487, 7757.27190397762, 7854.64690201066, 7946.89689897083, 
                         8040.89689575217, 8138.02189700387, 8307.0204177496, 8503.06577236996, 
                         8695.7523708755, 8856.44238854387, 8954.56739182212, 9060.31739378908, 
                         9204.92073382918, 9355.00415462664, 9511.9818620731, 9652.69611220357, 
                         9789.85990684429, 10024.7961342192, 10151.023718053, 10224.898720616, 
                         10381.1693198483, 10522.4193229775, 10654.5443243783, 10786.5965120559, 
                         10846.0965134268, 10960.2679118278, 11167.3618099042, 11277.9097646817, 
                         11389.9861795532, 11538.9426281007, 11776.6188905859, 11915.1188881421, 
                         12105.5073875858, 12255.4140234271, 12398.5070869529, 12626.7570857161, 
                         12906.241038388, 13112.5394410406, 13340.0510479716, 13579.9370223091, 
                         13804.2666475447, 13951.3916495414, 14086.8916484686, 14263.6683384968, 
                         14399.5433363213, 14535.4183341457, 14827.011492595, 0, 353.553390593274, 
                         748.838098114321, 1279.16818400423, 1632.72157459751, 2163.05166048742, 
                         2663.05166048742, 3163.05166048742, 3663.05166048742, 4163.05166048742, 
                         4663.05166048742, 5163.05166048742, 5663.05166048742, 6453.62107552951, 
                         7514.28124730933, 8221.38802849588, 8928.49480968243, 9428.49480968243, 
                         9928.49480968243, 10428.4948096824, 10928.4948096824, 11428.4948096824, 
                         12135.601590869, 12530.88629839, 12780.88629839, 13030.88629839, 
                         13280.88629839, 13811.2163842799, 14311.2163842799, 14811.2163842799, 
                         15206.501091801, 15456.501091801, 15851.785799322, 16351.785799322, 
                         16851.785799322, 17382.1158852119, 17735.6692758052, 18265.9993616951, 
                         18973.1061428817, 19473.1061428817, 19868.3908504027, 20118.3908504027, 
                         20368.3908504027, 20618.3908504027, 20868.3908504027, 21118.3908504027, 
                         21513.6755579238, 21908.9602654448, 22158.9602654448, 22689.2903513347, 
                         23084.5750588558, 23334.5750588558, 23864.9051447457, 24395.2352306356, 
                         24645.2352306356, 24998.7886212289, 25352.3420118221, 25602.3420118221, 
                         25852.3420118221, 26102.3420118221, 26352.3420118221, 26705.8954024154, 
                         27059.4487930087, 27413.002183602, 27766.5555741952, 28016.5555741952, 
                         28266.5555741952, 28620.1089647885, 28973.6623553818, 29327.2157459751, 
                         29680.7691365683, 30076.0538440894, 30783.1606252759, 31178.445332797, 
                         31428.445332797, 31958.7754186869, 32458.7754186869, 32958.7754186869, 
                         33489.1055045768, 33739.1055045768, 34134.3902120978, 34841.4969932844, 
                         35236.7817008054, 35590.3350913987, 35985.6197989198, 36515.9498848097, 
                         36765.9498848097, 37119.5032754029, 37473.0566659962, 37868.3413735173, 
                         38368.3413735173, 38898.6714594072, 39252.2248500004, 39605.7782405937, 
                         39959.331631187, 40312.8850217803, 40562.8850217803, 40812.8850217803, 
                         41166.4384123736, 41416.4384123736, 41666.4384123736, 42196.7684982635, 
                         0.467999994754791, 0.518999993801117, 0.37449999153614, 0.314000010490417, 
                         0.263999998569489, 0.226999998092651, 0.162750005722046, 0.12924998998642, 
                         0.109499990940094, 0.115749999880791, 0.144749999046326, 0.135250017046928, 
                         0.176499992609024, 0.164500001817942, 0.233499988913536, 0.204999998211861, 
                         0.164000004529953, 0.243000000715256, 0.306250005960464, 0.313500002026558, 
                         0.321999996900558, 0.32650001347065, 0.380749985575676, 0.361999988555908, 
                         0.439999997615814, 0.458999991416931, 0.578999996185303, 0.546500004827976, 
                         0.586000002920628, 0.555250003933907, 0.494000017642975, 0.425999999046326, 
                         0.429749995470047, 0.351750001311302, 0.339749991893768, 0.333999991416931, 
                         0.359000027179718, 0.396999999880791, 0.310249984264374, 0.336249992251396, 
                         0.325999975204468, 0.353999972343445, 0.364000022411346, 0.485000014305115, 
                         0.403999984264374, 0.204999983310699, 0.210500001907349, 0.246999979019165, 
                         0.258000016212463, 0.308499991893768, 0.260999977588654, 0.290000021457672, 
                         0.251249998807907, 0.279999971389771, 0.295000016689301, 0.378000020980835, 
                         0.408999979496002, 0.370000004768372, 0.367999970912933, 0.38400000333786, 
                         0.39300000667572, 0.562999993562698, 0.546000003814697, 0.543999999761581, 
                         0.365000009536743, 0.420000016689301, 0.425999999046326, 0.392000019550323, 
                         0.457000017166138, 0.430999994277954, 0.365000009536743, 0.337999999523163, 
                         0.326499998569489, 0.305000007152557, 0.28600001335144, 0.29899999499321, 
                         0.266000017523766, 0.262499988079071, 0.222000002861023, 0.254000008106232, 
                         0.306249991059303, 0.279500007629395, 0.279999971389771, 0.353999972343445, 
                         0.38824999332428, 0.567999988794327, 0.53999999165535, 0.537000000476837, 
                         0.310999989509583, 0.387500002980232, 0.525499992072582, 0.530000001192093, 
                         0.636999994516373, 0.650000005960464, 0.706999987363815, 0.562000006437302, 
                         0.615000009536743, 0.468999981880188, 0.53099998831749, 0.555999994277954, 
                         0.53099998831749, 0.559250004589558), .Dim = c(102L, 5L), .Dimnames = list(
                           NULL, c("x", "y", "cost_tot", "dist_tot", "cost_cell")))
  
  expect_true(all(round(lcp,6)==round(lcp_prev,6))) #differences in precision was messing with this
})